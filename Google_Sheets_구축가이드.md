# Google Sheets 구축 단계별 가이드

## 📋 준비물
- Google 계정
- 제공된 3개의 CSV 파일
  - 현장정보_샘플데이터.csv
  - 인력풀_샘플데이터.csv
  - 자격증풀_샘플데이터.csv

---

## 🚀 1단계: 스프레드시트 생성 및 데이터 입력

### 1-1. 새 스프레드시트 만들기
1. Google Drive 접속 (drive.google.com)
2. 좌측 상단 "새로 만들기" 클릭
3. "Google 스프레드시트" → "빈 스프레드시트" 선택
4. 파일명을 **"현장배정관리_DB"**로 변경

### 1-2. 시트 구성하기
1. 기본 생성된 "시트1"을 **"현장정보"**로 이름 변경
2. 하단의 "+" 버튼으로 새 시트 2개 추가
3. 시트명을 각각 **"인력풀"**, **"자격증풀"**로 변경

### 1-3. CSV 데이터 가져오기

**현장정보 시트에 데이터 입력:**
1. "현장정보" 시트 선택
2. 상단 메뉴: 파일 → 가져오기 → 업로드 탭
3. "현장정보_샘플데이터.csv" 파일 드래그 또는 선택
4. 가져오기 위치: **"현재 시트 바꾸기"** 선택
5. 구분 기호 유형: **"쉼표"** 선택
6. 데이터 가져오기 클릭

**인력풀 시트에 데이터 입력:**
1. "인력풀" 시트 선택
2. 파일 → 가져오기 → 업로드 탭
3. "인력풀_샘플데이터.csv" 파일 선택
4. 가져오기 위치: **"현재 시트 바꾸기"**
5. 데이터 가져오기 클릭

**자격증풀 시트에 데이터 입력:**
1. "자격증풀" 시트 선택
2. 파일 → 가져오기 → 업로드 탭
3. "자격증풀_샘플데이터.csv" 파일 선택
4. 가져오기 위치: **"현재 시트 바꾸기"**
5. 데이터 가져오기 클릭

---

## 🎨 2단계: 데이터 유효성 검사 설정

### 2-1. 현장정보 시트

**회사구분 컬럼 (C열) 드롭다운:**
1. C2 셀부터 끝까지 선택 (C2:C 형식)
2. 상단 메뉴: 데이터 → 데이터 확인
3. 기준: "목록(범위에서)" → "목록(항목 직접 입력)"
4. 항목 입력: `더존종합건설,더존하우징`
5. 셀에 드롭다운 목록 표시: 체크
6. 잘못된 데이터의 경우: "경고 표시" 선택
7. 저장

**현장상태 컬럼 (J열) 드롭다운:**
1. J2:J 선택
2. 데이터 → 데이터 확인
3. 항목 입력: `건축허가,착공예정,착공중,준공`
4. 저장

**배정상태 컬럼 (O열) 드롭다운:**
1. O2:O 선택
2. 데이터 → 데이터 확인
3. 항목 입력: `배정완료,미배정`
4. 저장

### 2-2. 인력풀 시트

**직책 컬럼 (C열) 드롭다운:**
1. C2:C 선택
2. 데이터 → 데이터 확인
3. 항목 입력: `소장,사무실장,사무직원,기타`
4. 저장

**현재상태 컬럼 (H열) 드롭다운:**
1. H2:H 선택
2. 데이터 → 데이터 확인
3. 항목 입력: `투입가능,투입중,휴가,퇴사`
4. 저장

### 2-3. 자격증풀 시트

**사용가능여부 컬럼 (J열) 드롭다운:**
1. J2:J 선택
2. 데이터 → 데이터 확인
3. 항목 입력: `사용가능,사용중,만료`
4. 저장

---

## 🌈 3단계: 조건부 서식 설정

### 3-1. 현장정보 시트

**배정상태에 따른 행 색상:**
1. O2:O 열 전체 선택
2. 서식 → 조건부 서식
3. 다음인 경우 셀 서식 지정: **"텍스트가 정확히 일치"**
4. 값: `미배정`
5. 서식 지정 스타일: 배경색 **연한 빨강 (#f4cccc)**
6. 완료

**현장상태 색상 구분:**
1. J2:J 열 선택
2. 조건부 서식 추가
   - **건축허가**: 연한 파랑 (#cfe2f3)
   - **착공예정, 착공중**: 연한 주황 (#fce5cd)
   - **준공**: 연한 초록 (#d9ead3)

### 3-2. 인력풀 시트

**현재상태 색상:**
1. H2:H 열 선택
2. 조건부 서식
   - **투입가능**: 연한 초록 (#d9ead3)
   - **투입중**: 연한 노랑 (#fff2cc)
   - **휴가**: 연한 회색 (#efefef)
   - **퇴사**: 연한 빨강 (#f4cccc)

### 3-3. 자격증풀 시트

**사용가능여부 색상:**
1. J2:J 열 선택
2. 조건부 서식
   - **사용가능**: 연한 초록 (#d9ead3)
   - **사용중**: 연한 노랑 (#fff2cc)
   - **만료**: 연한 빨강 (#f4cccc)

---

## 🔗 4단계: 관계 설정 (수식 활용)

### 4-1. 현장정보 시트에 소장명 자동 표시 추가

**새 컬럼 추가:**
1. 현장정보 시트의 L열 다음에 새 컬럼 삽입
2. 헤더명: **"담당소장명"** (M열)

**VLOOKUP 수식 입력:**
1. M2 셀 선택
2. 수식 입력:
```
=IF(ISBLANK(L2),"",VLOOKUP(L2,인력풀!A:B,2,FALSE))
```
3. M2 셀의 채우기 핸들을 아래로 드래그하여 수식 복사

**의미:**
- L2 (담당소장ID)가 비어있으면 공백
- 있으면 인력풀 시트에서 해당 ID의 성명(B열) 조회

### 4-2. 현장정보 시트에 자격증 소유자명 자동 표시

**새 컬럼 추가:**
1. 현장정보 시트의 N열 다음에 새 컬럼 삽입
2. 헤더명: **"자격증소유자명"** (O열)

**VLOOKUP 수식:**
1. O2 셀 선택
2. 수식 입력:
```
=IF(ISBLANK(N2),"",VLOOKUP(N2,자격증풀!A:E,5,FALSE))
```
3. 수식 복사

---

## 📊 5단계: 열 너비 및 서식 조정

### 5-1. 모든 시트 공통
1. 헤더 행(1행) 선택
2. 서식 → 텍스트 → 굵게
3. 서식 → 맞춤 → 가운데 정렬
4. 배경색: 연한 회색 (#f3f3f3)

### 5-2. 열 너비 자동 조정
1. 전체 시트 선택 (좌측 상단 모서리 클릭)
2. 열 너비를 내용에 맞게 자동 조절

---

## 🔒 6단계: 데이터 보호 및 공유 설정

### 6-1. 헤더 행 고정
1. 각 시트에서 1행 선택
2. 상단 메뉴: 보기 → 고정 → 1개 행

### 6-2. 공유 설정
1. 우측 상단 "공유" 버튼 클릭
2. 액세스 권한:
   - **일반 액세스**: 제한됨 (특정 사용자만)
   - 사용자 추가: 팀원 이메일 입력
   - 역할: **편집자** 또는 **뷰어**

---

## ✅ 7단계: 최종 검증

### 검증 체크리스트
- [ ] 3개 시트 모두 데이터 정상 입력됨
- [ ] 드롭다운 목록 작동 확인
- [ ] 조건부 서식 색상 표시 확인
- [ ] VLOOKUP 수식 작동 확인 (자동 조회)
- [ ] 헤더 행 고정 확인
- [ ] 팀원과 공유 완료

---

## 📱 8단계: AppSheet 연동 (선택사항)

### 8-1. AppSheet 시작하기
1. appsheet.com 접속
2. Google 계정으로 로그인
3. "Create" → "Start with your own data" 클릭

### 8-2. 데이터 연결
1. "Google Sheets" 선택
2. 방금 만든 "현장배정관리_DB" 선택
3. "Choose" 클릭
4. 3개 시트 모두 선택
5. "Create app" 클릭

### 8-3. 관계 설정
1. Data 탭 → 각 테이블 선택
2. "현장정보" 테이블:
   - Columns 탭에서 "담당소장ID" 컬럼 선택
   - Type: **Ref** 선택
   - Source table: **인력풀** 선택
3. "사용자격증ID"도 동일하게 **자격증풀** 참조 설정

### 8-4. 지도 뷰 생성
1. UX 탭 → Views → Primary Views
2. "현장정보" 뷰 선택
3. View type: **Map** 선택
4. Position: "위도", "경도" 컬럼 선택
5. Save

---

## 💡 활용 팁

### 데이터 추가 방법
1. **현장 추가**: 현장정보 시트 마지막 행에 데이터 입력
2. **소장 추가**: 인력풀 시트에 새 인력 추가
3. **자격증 추가**: 자격증풀 시트에 새 자격증 추가

### 필터 활용
1. 데이터 → 필터 만들기
2. 회사구분, 배정상태 등으로 필터링

### 피벗 테이블 활용
1. 삽입 → 피벗 테이블
2. 회사별 현장 수, 소장별 담당 현장 수 등 분석

---

## 🆘 문제 해결

**Q. CSV 한글이 깨져요**
A. CSV 파일을 메모장으로 열어서 "다른 이름으로 저장" → 인코딩 UTF-8 선택

**Q. VLOOKUP이 #N/A 오류가 나요**
A. 참조하는 ID가 정확한지 확인 (공백, 대소문자)

**Q. 조건부 서식이 적용 안 돼요**
A. 범위를 다시 확인하고 규칙 순서 조정

**Q. AppSheet에서 지도가 안 보여요**
A. 위도/경도 컬럼이 Number 타입인지 확인

---

## 📞 추가 지원

더 자세한 도움이 필요하시면 다음 내용을 알려주세요:
1. 구체적인 오류 메시지
2. 스크린샷
3. 어떤 단계에서 문제가 발생했는지

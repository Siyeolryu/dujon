# 현장배정 관리 시스템 - DB 구조 설계

## 📊 전체 구조 개요

Google Sheets를 활용하여 3개의 시트(테이블)로 구성합니다.

```
현장배정관리_DB.xlsx
├── [시트1] 현장정보 (Sites)
├── [시트2] 인력풀 (Personnel)
└── [시트3] 자격증풀 (Certificates)
```

---

## 1️⃣ 시트1: 현장정보 (Sites)

### 컬럼 구조

| 컬럼명 | 데이터타입 | 필수 | 설명 | 예시 |
|--------|-----------|------|------|------|
| **현장ID** | TEXT | ✅ | 고유 식별자 (S001, H001 형식) | S001 |
| **현장명** | TEXT | ✅ | 현장 이름 | 평택 푸르지오 |
| **회사구분** | TEXT | ✅ | 더존종합건설 / 더존하우징 | 더존종합건설 |
| **주소** | TEXT | ✅ | 전체 주소 (지도 좌표 변환용) | 경기도 평택시 비전동 123 |
| **위도** | NUMBER | ⚠️ | 지도 표시용 (자동생성 가능) | 36.9921 |
| **경도** | NUMBER | ⚠️ | 지도 표시용 (자동생성 가능) | 126.9730 |
| **건축허가일** | DATE | ⚠️ | 허가 받은 날짜 | 2025-12-10 |
| **착공예정일** | DATE | ✅ | 착공 시작 예정일 | 2026-03-15 |
| **준공일** | DATE | ⚠️ | 준공 예정/완료일 | 2027-12-30 |
| **현장상태** | TEXT | ✅ | 건축허가/착공예정/착공중/준공 | 착공예정 |
| **특이사항** | TEXT |  | 현장 특성, 주의사항 | 대단지 아파트 (1,200세대) |
| **담당소장ID** | TEXT |  | 인력풀 시트의 소장ID 참조 | P001 |
| **사용자격증ID** | TEXT |  | 자격증풀 시트의 자격증ID 참조 | C001 |
| **준공필증파일URL** | TEXT |  | 클라우드 저장소 URL | https://drive.google.com/... |
| **배정상태** | TEXT | ✅ | 배정완료 / 미배정 | 배정완료 |
| **등록일** | DATE | ✅ | 데이터 등록일 | 2025-11-01 |
| **수정일** | DATE | ✅ | 마지막 수정일 | 2026-01-05 |

### 데이터 예시 (첫 3행)

| 현장ID | 현장명 | 회사구분 | 주소 | 위도 | 경도 | 건축허가일 | 착공예정일 | 준공일 | 현장상태 | 특이사항 | 담당소장ID | 사용자격증ID | 배정상태 |
|--------|--------|---------|------|------|------|-----------|-----------|--------|---------|---------|-----------|-------------|---------|
| S001 | 평택 푸르지오 | 더존종합건설 | 경기도 평택시 비전동 123 | 36.9921 | 126.9730 | 2025-12-10 | 2026-03-15 | 2027-12-30 | 착공예정 | 대단지 아파트 | P001 | C001 | 배정완료 |
| S002 | 수원 힐스테이트 | 더존종합건설 | 경기도 수원시 영통구 456 | 37.2636 | 127.0286 | 2026-01-05 | 2026-04-01 | 2027-10-15 | 착공예정 | 역세권 개발 | P002 | C002 | 배정완료 |
| S003 | 용인 동백 자이 | 더존종합건설 | 경기도 용인시 기흥구 789 | 37.2639 | 127.1483 | 2026-02-20 | 2026-05-10 | 2028-03-20 | 건축허가 | 학군지 인기단지 | (공백) | C015 | 미배정 |

---

## 2️⃣ 시트2: 인력풀 (Personnel)

### 컬럼 구조

| 컬럼명 | 데이터타입 | 필수 | 설명 | 예시 |
|--------|-----------|------|------|------|
| **인력ID** | TEXT | ✅ | 고유 식별자 (P001 형식) | P001 |
| **성명** | TEXT | ✅ | 이름 | 김현장 |
| **직책** | TEXT | ✅ | 소장/사무실장/사무직원/기타 | 소장 |
| **소속** | TEXT | ✅ | 더존종합건설 / 더존하우징 / 본사 | 더존종합건설 |
| **연락처** | TEXT | ✅ | 휴대폰 번호 | 010-1234-5678 |
| **이메일** | TEXT |  | 이메일 주소 | kim@example.com |
| **보유자격증** | TEXT |  | 보유한 자격증 목록 (참고용) | 건축기사, 안전관리자 |
| **현재상태** | TEXT | ✅ | 투입가능/투입중/휴가/퇴사 | 투입중 |
| **현재담당현장수** | NUMBER |  | 담당 중인 현장 개수 | 3 |
| **비고** | TEXT |  | 특이사항, 경력 등 | 15년차 베테랑 |
| **입사일** | DATE |  | 입사일 | 2010-03-02 |
| **등록일** | DATE | ✅ | 데이터 등록일 | 2025-11-01 |

### 데이터 예시

| 인력ID | 성명 | 직책 | 소속 | 연락처 | 보유자격증 | 현재상태 | 현재담당현장수 | 비고 |
|--------|------|------|------|--------|-----------|---------|--------------|------|
| P001 | 김현장 | 소장 | 더존종합건설 | 010-1234-5678 | 건축기사, 안전관리자 | 투입중 | 3 | 15년차 |
| P002 | 이소장 | 소장 | 더존종합건설 | 010-2345-6789 | 건축산업기사 | 투입중 | 2 | 아파트 전문 |
| P003 | 박사무실장 | 사무실장 | 본사 | 010-9999-1111 | 건축기사 | 투입가능 | 0 | 자격증만 대여 |
| P004 | 최사무실 | 사무직원 | 본사 | 010-8888-2222 | 건축기사 | 투입가능 | 0 | 자격증만 대여 |

---

## 3️⃣ 시트3: 자격증풀 (Certificates)

### 컬럼 구조

| 컬럼명 | 데이터타입 | 필수 | 설명 | 예시 |
|--------|-----------|------|------|------|
| **자격증ID** | TEXT | ✅ | 고유 식별자 (C001 형식) | C001 |
| **자격증명** | TEXT | ✅ | 자격증 이름 | 건축기사 |
| **자격증번호** | TEXT |  | 자격증 고유번호 | 12-34-567890 |
| **소유자ID** | TEXT | ✅ | 인력풀의 인력ID 참조 | P001 |
| **소유자명** | TEXT | ✅ | 이름 (조회 편의) | 김현장 |
| **소유자연락처** | TEXT | ✅ | 연락처 (조회 편의) | 010-1234-5678 |
| **발급기관** | TEXT |  | 한국산업인력공단 등 | 한국산업인력공단 |
| **취득일** | DATE |  | 자격증 취득일 | 2008-11-20 |
| **유효기간** | DATE |  | 갱신 필요 시 | 2028-11-20 |
| **사용가능여부** | TEXT | ✅ | 사용가능/사용중/만료 | 사용가능 |
| **현재사용현장ID** | TEXT |  | 사용 중인 현장ID | S001 |
| **비고** | TEXT |  | 특이사항 | 안전관리자 겸임 가능 |
| **등록일** | DATE | ✅ | 데이터 등록일 | 2025-11-01 |

### 데이터 예시

| 자격증ID | 자격증명 | 자격증번호 | 소유자ID | 소유자명 | 소유자연락처 | 사용가능여부 | 현재사용현장ID | 비고 |
|---------|---------|-----------|---------|---------|------------|------------|--------------|------|
| C001 | 건축기사 | 12-34-567890 | P001 | 김현장 | 010-1234-5678 | 사용중 | S001 | 소장 본인 사용 |
| C002 | 건축산업기사 | 12-34-567891 | P002 | 이소장 | 010-2345-6789 | 사용중 | S002 | 소장 본인 사용 |
| C015 | 건축기사 | 12-34-567905 | P003 | 박사무실장 | 010-9999-1111 | 사용중 | S003 | 사무직원 자격증 대여 |
| C016 | 건축기사 | 12-34-567906 | P004 | 최사무실 | 010-8888-2222 | 사용가능 | (공백) | 대여 가능 |

---

## 🔗 테이블 간 관계 (Relationships)

```
현장정보 (Sites)
    ├─ 담당소장ID → 인력풀.인력ID (1:1 관계)
    └─ 사용자격증ID → 자격증풀.자격증ID (1:1 관계)

인력풀 (Personnel)
    └─ 인력ID ← 자격증풀.소유자ID (1:N 관계, 한 사람이 여러 자격증 보유 가능)

자격증풀 (Certificates)
    ├─ 소유자ID → 인력풀.인력ID
    └─ 현재사용현장ID → 현장정보.현장ID
```

---

## 📝 주요 활용 시나리오

### 시나리오 1: 소장 있고, 소장 자격증 사용
- 현장정보: 담당소장ID = P001, 사용자격증ID = C001
- 인력풀: P001 (김현장)
- 자격증풀: C001 (소유자: P001 김현장)

### 시나리오 2: 소장 없고, 사무직원 자격증 사용
- 현장정보: 담당소장ID = (공백), 사용자격증ID = C015
- 인력풀: P003 (박사무실장)
- 자격증풀: C015 (소유자: P003 박사무실장)

### 시나리오 3: 완전 미배정
- 현장정보: 담당소장ID = (공백), 사용자격증ID = (공백)

---

## 🔍 필수 데이터 검증 규칙

### 1. 현장정보 시트
- **현장ID**: 중복 불가, 형식 체크 (S001, H001)
- **회사구분**: "더존종합건설" 또는 "더존하우징"만 입력
- **현장상태**: "건축허가", "착공예정", "착공중", "준공" 중 선택
- **배정상태**: "배정완료" 또는 "미배정"
- **담당소장ID**: 인력풀에 존재하는 ID만 입력 가능
- **사용자격증ID**: 자격증풀에 존재하는 ID만 입력 가능

### 2. 인력풀 시트
- **인력ID**: 중복 불가, 형식 체크 (P001)
- **직책**: "소장", "사무실장", "사무직원", "기타" 중 선택
- **현재상태**: "투입가능", "투입중", "휴가", "퇴사" 중 선택

### 3. 자격증풀 시트
- **자격증ID**: 중복 불가, 형식 체크 (C001)
- **사용가능여부**: "사용가능", "사용중", "만료" 중 선택
- **소유자ID**: 인력풀에 존재하는 ID만 입력 가능

---

## 🚀 Google Sheets 구축 단계

### 1단계: 스프레드시트 생성
```
파일명: 현장배정관리_DB
3개 시트 생성: 현장정보, 인력풀, 자격증풀
```

### 2단계: 각 시트 헤더 입력
위 컬럼 구조대로 첫 행에 헤더 입력

### 3단계: 데이터 유효성 검사 설정
- 드롭다운 목록: 회사구분, 현장상태, 배정상태, 직책, 현재상태, 사용가능여부
- 날짜 형식: 건축허가일, 착공예정일, 준공일, 입사일 등
- 전화번호 형식: 010-XXXX-XXXX

### 4단계: 조건부 서식 적용
- 배정상태 "미배정" → 빨간색 표시
- 현장상태에 따라 색상 구분
- 자격증 사용가능여부에 따라 색상 구분

### 5단계: 관계 설정 (수식 활용)
- VLOOKUP으로 ID 기반 자동 조회
- 예: 담당소장ID 입력 시 소장명/연락처 자동 표시

---

## 💡 AppSheet/Glide 연동 시 추가 설정

### 연동 방법
1. Google Sheets를 AppSheet/Glide에 연결
2. 각 시트를 테이블로 인식
3. 관계(Relationship) 설정:
   - Sites.담당소장ID → Personnel.인력ID
   - Sites.사용자격증ID → Certificates.자격증ID

### 앱 화면 구성
- **메인 화면**: 지도 뷰 (Sites 테이블 기반)
- **상세 화면**: 현장 정보 + 관련 인력/자격증 정보 자동 표시
- **관리 화면**: 인력풀, 자격증풀 관리

---

## 📊 샘플 데이터 생성

샘플 데이터 50개를 생성하여 테스트에 활용하세요.
- 현장정보: 50개
- 인력풀: 20명 (소장 10명, 사무직원 10명)
- 자격증풀: 30개 (소장 자격증 10개, 사무직원 자격증 20개)

---

## ✅ 체크리스트

- [ ] Google Sheets 생성 완료
- [ ] 3개 시트 구조 설정 완료
- [ ] 데이터 유효성 검사 적용
- [ ] 조건부 서식 설정
- [ ] 샘플 데이터 입력 (최소 10개)
- [ ] AppSheet/Glide 연동 테스트
- [ ] 관계 설정 확인
- [ ] 지도 API 연동 확인

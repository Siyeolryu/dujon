# 개발일지 2026-01-30 - 개발 현황

**작성일**: 2026년 1월 30일  
**작성자**: 개발팀  
**구분**: 주간 개발 현황

---

## 📌 오늘 요약

- **개발일지 폴더** 생성 및 작성 규칙 정립 (`개발일지_날짜_제목.md`)
- **Phase 2-1 데이터 조회 API** 단계별 구현 완료
- **Phase 2-2 데이터 수정 API** 단계별 구현 완료
- REST API 서버로 현장·인력·자격증 조회/수정/배정·배정해제 가능

---

## ✅ 완료된 작업

### 1. 개발일지 체계 구축
- `개발일지/` 폴더 생성
- `README.md`: 작성 규칙 (파일명 `개발일지_날짜_제목.md`, 같은 날 제목만 다르게 가능)
- `개발일지_2026-01-30_프로젝트현황.md`: 프로젝트 전체 현황 정리

### 2. Phase 2-1 데이터 조회 API (완료)

| 구분 | 내용 |
|------|------|
| **폴더 구조** | `api/`, `api/routes/`, `api/services/`, `api/models/`, `api/utils/` |
| **Sheets 서비스** | `sheets_service.py` – 시트1/2/3 읽기, 17·22컬럼 현장정보 지원 |
| **Flask 앱** | `api/app.py` – CORS, 루트·헬스·에러 핸들러 |
| **라우트** | sites, personnel, certificates, stats (GET 전용) |

**엔드포인트**
- `GET /api/sites` (필터: company, status, state)
- `GET /api/sites/search?q=검색어`
- `GET /api/sites/<id>`
- `GET /api/personnel` (필터: status, role)
- `GET /api/personnel/<id>`
- `GET /api/certificates` (필터: available)
- `GET /api/certificates/<id>`
- `GET /api/stats`
- `GET /api/health`

### 3. Phase 2-2 데이터 수정 API (완료)

| 구분 | 내용 |
|------|------|
| **Sheets 확장** | `update_cell`, `update_row`, `batch_update`, `find_row_by_id`, `append_row` |
| **검증** | `api/services/validation.py` – 현장 데이터 검증, 배정 가능 여부 검증 |
| **현장** | POST 생성, PUT 수정, POST assign, POST unassign |
| **인력/자격증** | PUT 수정 |

**엔드포인트**
- `POST /api/sites` – 현장 생성 (필수: 현장ID, 현장명, 회사구분, 주소)
- `PUT /api/sites/<id>` – 현장 수정 (22컬럼 시트 기준)
- `POST /api/sites/<id>/assign` – 소장 배정 (manager_id, certificate_id)
- `POST /api/sites/<id>/unassign` – 소장 배정 해제
- `PUT /api/personnel/<id>` – 인력 정보 수정
- `PUT /api/certificates/<id>` – 자격증 정보 수정

**배정/해제 시 연동**
- 현장: 담당소장ID, 사용자격증ID, 배정상태, 수정일
- 인력: 현재담당현장수 ±1, 현재상태(투입중/투입가능)
- 자격증: 사용가능여부, 현재사용현장ID

---

## 📁 추가·변경된 파일 (1/30 기준)

```
api/
├── __init__.py
├── app.py                    # 2-1·2-2 반영
├── README.md                 # 엔드포인트 정리
├── routes/
│   ├── sites.py              # GET + POST/PUT/assign/unassign
│   ├── personnel.py          # GET + PUT
│   ├── certificates.py       # GET + PUT
│   └── stats.py              # GET
├── services/
│   ├── sheets_service.py     # read + update/batch/find_row/append
│   └── validation.py         # 신규 (2-2)
├── models/
├── utils/
개발일지/
├── README.md
├── 개발일지_2026-01-30_프로젝트현황.md
└── 개발일지_2026-01-30_개발현황.md   # 본 문서

run_api.py                    # API 서버 실행
requirements_api.txt
.env.example
```

---

## 📊 Phase 2 진행도

| 단계 | 내용 | 상태 |
|------|------|------|
| 2-1 | 데이터 조회 API | ✅ 완료 |
| 2-2 | 데이터 수정 API | ✅ 완료 |
| 2-3 | 실시간 동기화 (선택) | ⏳ 미진행 |
| 3단계 | HTML 앱 API 연동·소장 배정 UI | ⏳ 예정 |
| 4단계 | 배포·테스트 | ⏳ 예정 |

---

## ⏭️ 다음 단계

1. **API 서버 실행 검증**  
   - 프로젝트 루트에서 `python run_api.py`  
   - `token.pickle`, `client_secret_xxx.json` 준비  
   - 시트 이름: 시트1, 시트2, 시트3 (22컬럼 권장)

2. **Phase 2-3단계**  
   - HTML 앱에서 API 호출로 전환  
   - 소장 배정 UI (미배정 현장 클릭 → 배정 패널)

3. **선택**  
   - 실시간 동기화(2-3), 통합 테스트

---

## 📝 비고

- 현장 수정/배정은 **시트1이 22컬럼(VLOOKUP 포함)** 구조를 기준으로 구현됨. 17컬럼만 있을 경우 1-3 VLOOKUP 적용 후 사용 권장.
- 개발일지 파일명 규칙: `개발일지_YYYY-MM-DD_제목.md`, 같은 날 여러 일지는 제목만 구분.

---

**다음 개발일지**: Phase 2-3단계 착수 또는 주간 현황 정리 시

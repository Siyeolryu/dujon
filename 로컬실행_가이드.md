# 로컬 실행 가이드 (프론트엔드 + 백엔드 연결)

프론트엔드와 백엔드를 **한 서버**에서 띄워 `http://localhost:5000/` 으로 확인할 수 있습니다.

---

## 1. 실행 방법 (권장: Node.js)

### 방법 A: Node.js 서버 (Python 없이 동작)

**RUN_NODE_SERVER.bat** 을 더블클릭하거나, 터미널에서:

```bash
node server.js
```

- Python 설치 불필요. Node.js만 있으면 됩니다.
- API는 빈 데이터(목)로 응답하며, 화면·연결 확인용입니다.
- 실제 Google 시트 연동은 Python(Flask) 서버를 사용하세요.

### 방법 B: Python(Flask) 서버 (실제 API + 시트 연동)

**START_SERVER.cmd** 또는 **run_local.bat** 더블클릭, 또는:

```bash
python run_api.py
```

- `.env` / Google 시트 설정 시 실제 데이터 사용 가능.
- Python이 PATH에 없으면 "Python을 찾을 수 없습니다"가 나올 수 있음 → 이 경우 **방법 A(Node)** 사용.

---

## 2. 접속 주소 (Node / Python 모두 동일)

실행 후 브라우저에서 아래 주소로 접속하세요.

| 용도 | 주소 |
|------|------|
| **프론트엔드 (현장배정 화면)** | **http://localhost:5000/** |
| API 정보 (JSON) | http://localhost:5000/api-info |
| 헬스 체크 | http://localhost:5000/api/health |
| 완료 체크리스트 | http://localhost:5000/ui/완료_확인_체크리스트.html |
| **Streamlit 웹 UI** | **http://localhost:8501/** (Streamlit 별도 실행 시) |

---

## 2-2. Streamlit으로 웹 운영 (선택)

Streamlit 기반 UI를 쓰려면:

1. **터미널 1**: `python run_api.py` (Flask API, 포트 5000)
2. **터미널 2**: `streamlit run app_streamlit.py` (Streamlit, 포트 8501)
3. 브라우저에서 **http://localhost:8501** 접속

자세한 내용은 [Streamlit_운영_가이드.md](Streamlit_운영_가이드.md)를 참고하세요.

---

## 3. 동작 방식

- **Flask**가 포트 **5000**에서 동시에:
  - **API**: `/api/*` (현장, 인력, 자격증, 통계, 배정 등)
  - **프론트엔드**: `/` → `site-management.html`, `/css/*`, `/js/*`, `/ui/*` 정적 파일
- 프론트엔드(`config.js`)는 **같은 호스트**일 때 `location.origin + '/api'` 로 API를 호출합니다.

---

## 4. 사전 준비

- **Python 3** 설치
- 의존성 설치:

  ```bash
  pip install -r requirements_api.txt
  ```

- (선택) Google 시트 연동 시 `.env` 설정  
  - 없어도 API는 동작하며, 데이터는 빈 값 또는 목업으로 나올 수 있습니다.

---

## 5. 종료

터미널/명령 프롬프트 창에서 **Ctrl+C** 로 서버를 종료합니다.

---

## 6. 문제 해결

### "Connection Failed" / ERR_CONNECTION_REFUSED

- **원인**: 서버가 떠 있지 않음.
- **조치**:
  1. **run_local.bat** 을 더블클릭해 실행했는지 확인.
  2. 창이 바로 닫히면: **명령 프롬프트(cmd)** 를 열고, 프로젝트 폴더로 이동한 뒤 `run_local.bat` 또는 `python run_api.py` 실행. 오류 메시지가 있으면 그대로 확인.
  3. Python 미설치/미인식 시: [python.org](https://www.python.org/downloads/) 에서 설치하고, 설치 시 **"Add Python to PATH"** 를 체크.

### Python을 찾을 수 없습니다

- **조치**: Python 설치 후 **명령 프롬프트를 다시 열고** `python --version` 으로 확인.  
  또는 `py -3 run_api.py` 로 실행.

### Google 시트 미설정

- **SPREADSHEET_ID** 가 없어도 서버는 기동되며, 현장/인력/자격증 API는 **빈 목록**을 반환합니다.
- 화면(프론트엔드)과 API 연결만 확인하려면 그대로 사용하면 됩니다.
- 실제 데이터를 쓰려면 `.env` 에 `SPREADSHEET_ID` 를 넣고 Google 시트 연동을 설정하세요.

# 백엔드-프론트엔드 연결 문제 확인 방법

**목적**: FE↔BE 연결 구간에서 오류(네트워크, 4xx/5xx) 발생 시 어디서 확인할 수 있는지 정리합니다.

---

## 1. 프론트엔드에서 확인

### 1.1 브라우저 콘솔 (개발자 도구)

API 요청이 실패하면 **콘솔에 경고**가 출력됩니다.

- **형식**: `[FE↔BE] url=... method=... status=... code=... msg=... request_id=...`
- **예시**:
  - `[FE↔BE] url=http://localhost:5000/api/sites method=GET status=500 code=INTERNAL_ERROR msg=서버 내부 오류... request_id=a1b2c3d4`
  - `[FE↔BE] url=http://localhost:5000/api/sites method=GET status=0 code=NETWORK msg=Failed to fetch request_id=`
- **확인 방법**: F12 → Console 탭 → `[FE↔BE]` 검색

### 1.2 디버그 수집 (Cursor 디버그 세션)

동일한 실패 시 **디버그 수집 서버**로 한 건이 전송됩니다 (실패해도 앱 동작에는 영향 없음).

- **수집 서버**: `http://127.0.0.1:7242/ingest/...`
- **로그 파일**: `.cursor/debug.log` (NDJSON 한 줄씩 추가)

---

## 2. 백엔드에서 확인

### 2.1 Flask 로거 (콘솔/파일)

- **404**: `logger.warning('404 NOT_FOUND path=... method=... request_id=...')`
- **500**: `logger.exception('500 INTERNAL_ERROR ...')`

서버를 실행한 터미널에서 위 메시지와 `request_id`를 확인할 수 있습니다.

### 2.2 연결 구간 로그 파일

**4xx/5xx 응답이 나갈 때마다** 아래 파일에 NDJSON 한 줄이 추가됩니다.

- **경로**: `.cursor/debug.log`
- **형식 예시**:
```json
{"location":"api/app.py:after_request","message":"BE connection error response","data":{"path":"/api/sites/S999","method":"GET","status_code":404,"error_code":"SITE_NOT_FOUND","request_id":"a1b2c3d4"},"timestamp":1738...,"sessionId":"fe-be-connection","hypothesisId":"connection-fail"}
```

- **포함 정보**: `path`, `method`, `status_code`, `error_code`, `request_id`

---

## 3. request_id로 맞춰보기

1. **프론트**: 콘솔 `[FE↔BE]` 로그의 `request_id=xxxx`
2. **백엔드**: Flask 로그 또는 `.cursor/debug.log`의 `"request_id":"xxxx"`

같은 `request_id`로 프론트에서 본 오류와 백엔드에서 기록된 오류를 대응할 수 있습니다.

---

## 4. 정리

| 확인 위치 | 내용 |
|-----------|------|
| **브라우저 콘솔** | FE에서 감지한 실패 (url, status, code, request_id) |
| **API 서버 터미널** | BE 404/500 시 Flask warning/exception 로그 |
| **`.cursor/debug.log`** | BE 4xx/5xx 응답 시 NDJSON 한 줄, FE 실패 시 디버그 수집으로 추가될 수 있음 |

문제 발생 시 위 세 곳을 보면 **연결 구간**에서의 오류를 확인할 수 있습니다.
